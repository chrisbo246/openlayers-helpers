"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},openlayersHelpers=function(e,t,r){var o=function(e){var t=[];for(var r in e)"function"==typeof e[r]&&t.push(r);return t},n=function(e,t){var r=o(t),n=[];return"object"===("undefined"==typeof r?"undefined":_typeof(r))&&"function"==typeof r.forEach&&r.forEach(function(r,o){e instanceof t[r]&&n.push(r)}),n},a=function s(e,t){e.getLayers().forEach(function(e,r,o){e instanceof ol.layer.Group||t(e,r,o),e.getLayers&&s(e,t)})},l=function(e){var t=[];return JSON.stringify(e,function(e,r){if(r===1/0)r="Infinity";else if(NaN===r)r="NaN";else if("object"===("undefined"==typeof r?"undefined":_typeof(r))&&null!==r){if(-1!==t.indexOf(r))return;t.push(r)}return r});var t},i=function(e){return JSON.parse(e,function(e,t){return"Infinity"===t?t=1/0:"NaN"===t&&(t=NaN),t})};return{forEachLayerRecursive:a,stringify:l,parse:i,getMethods:o,getInstanceTypes:n}}(window.jQuery,window,document),inputHelpers=function(e,t,r,o){var n=function(e){var r,o=t(e);return o&&(r=o.attr("type"),r&&"undefined"!==r||(r=o.prop("tagName").toLowerCase())),r},a=function(e){var r,o=t(e);if(o){var a=n(o);-1!==t.inArray(a,["radio","checkbox"])?(r=o.prop("checked"),r&&o.attr("value")&&(r=o.attr("value"))):r="file"===a?o.prop("files"):-1!==t.inArray(a,["text","password","select","textarea","hidden","color","date","datetime","datetime-local","email","month","number","range","search","tel","time","url","week"])?o.val():o.html()}return r},l=function(e,r,o,a){var l=t(e);if(l){var i=n(l);t.isArray(r)&&"textarea"!==i&&(r=r[0]||null),-1!==t.inArray(i,["radio","checkbox"])?l.prop("checked",r):"file"===i?"FileList"===t.type(r)&&l.attr("files",r):"textarea"===i?(t.isArray(r)&&(r=r.join("\n")),l.val(r)):-1!==t.inArray(i,["text","password","select","hidden","color","date","datetime","datetime-local","email","month","number","range","search","tel","time","url","week"])?l.val(r):l.html(r),o&&l.attr(o),a!==!1&&l.trigger("change")}},i=function(e,o,n){if(!(r.File&&r.FileReader&&r.FileList&&r.Blob))return!1;var a=new t.Deferred,l=0;return spinner&&spinner.addJob(a),n=t.extend(!0,{},{format:"text",encoding:"UTF-8",cancelSelector:null},n),t.each(e,function(r,i){var s=new FileReader;"buffer"===n.format?s.readAsArrayBuffer(i,n.encoding):"binary"===n.format?s.readAsBinaryString(i,n.encoding):"data"===n.format?s.readAsDataURL(i,n.encoding):s.readAsText(i,n.encoding),s.onload=function(e){console.log("File load",e),o(e.target.result)},s.onloadstart=function(){},s.onloadend=function(){console.log(r+1+"/"+e.length+" file loaded"),l+=1,l===e.length&&(console.log("Last file loaded"),a.resolve())},s.onerror=function(){swal({title:"Oups!",text:"An error occured while trying to read your file.",type:"warning"})},n.cancelSelector&&t(n.cancelSelector).on("click",function(){s.abort()})}),a};return t.extend(e,{getInputValue:a,setInputValue:l,reader:i})}(openlayersHelpers||{},window.jQuery,window,document),openlayersLayerHelpers=function(e,t,r,o){var n,a={debug:"localhost"===o.domain,properties:{visible:!1},basil:{}},l=a;"function"==typeof Basil&&(n=new r.Basil(l.basil));var i=function(e){return l.debug?void"change change:blur change:extent change:gradient change:layers change:maxResolution change:minResolution change:opacity change:preload change:radius change:source change:useInterimTilesOnError change:visible change:zIndex".split(" ").forEach(function(t){e.on(t,function(t){t.key?console.log("Layer "+t.key+" changed",e.get(t.key)):console.log(t.target.get("name")+" layer"+t.type,t)})}):(webappHelpers.hideLogs(),!1)},s=function(e,r){if(!e)return!1;var o=e.getSource();"undefined"!=typeof o.setUrls&&(t.isArray(r)?o.setUrls(r):(r=t.trim(r),o.setUrl(r)))},c=function(e,t,r){if(0===t.length)return!1;var o=e.getSource();o.clear();var n=webappHelpers.reader(t,function(t){var n=o.getFormat(),a=n.readFeatures(t,r);o.addFeatures(a),e.setVisible(!0)});return n},p=function g(e,t,r){if(e.get(t)===r)return e;if(e.getLayers){var o,n=e.getLayers().getArray();n.forEach(function(e){return o=g(e,t,r),o?o:void 0})}return null},u=function h(e,r){t.each(e,function(e,t){t.getLayers()?h(t,r):r(t)})},m=function(e){var r=!1,o=["Base","Group","Heatmap","Image","Layer","Tile","Vector","VectorTile"];return t.each(o,function(t,o){return"function"==typeof ol.layer[o]?(r=e instanceof ol.layer[o],!r):void 0}),r},y=function(e){var r=[];return t.each(e,function(e,t){r.push(d(e,t))}),r.filter(function(e){return e})},d=function(e,r){if("function"!=typeof openlayersPredefinedLayers[e])return console.warn(e+" layer definition is not defined"),new ol.layer.Tile;var o=openlayersPredefinedLayers[e]();return m(o)||(console.warn("Invalid layer returned by",e),o=new ol.layer.Tile),r=t.extend(!0,{},l.properties,r),o.setProperties(r),f(o,r),o},f=function(e){return i(e),e};return t.extend(e,{initLayer:f,loadFileFeatures:c,findLayerBy:p,settings:l,treatLayers:u,updateSourceUrl:s,isLayer:m,getPredefinedLayer:d,getPredefinedLayers:y})}(openlayersHelpers||{},window.jQuery,window,document),openlayersControlHelpers=function(e,t,r,o){var n=function(e){var r=[];return t.each(e,function(e,t){r.push(a(e,t))}),r.filter(function(e){return e})},a=function(e){if("function"!=typeof openlayersPredefinedControls[e])return console.warn(e+" control definition is not defined"),!1;var t=openlayersPredefinedControls[e]();return i(t),t},l=function(e,t){var r,o=e.getControls();return o.forEach(function(e){e instanceof ol.control[t]&&(r=e)}),r},i=function(e){console.log("Control properties before saved",e.getProperties()),"function"==typeof e.getCollapsible&&(e.set("collapsibleDefault",e.get("collapsible")),console.log("Control propery saved",e.getProperties()))};return t.extend(e,{getPredefinedControl:a,getPredefinedControls:n,getControlInstanceOf:l})}(openlayersHelpers||{},window.jQuery,window,document),openlayersMapHelpers=function(e,t,r,o){var n={ol:{},narrowWidth:320,flatHeight:480,persistence:!0,centerOnPosition:!0,debug:"localhost"===o.domain},a=function(e){var t=e.getView();"change change:layerGroup change:size change:target change:view click dblclick moveend pointerdrag propertychange singleclick".split(" ").forEach(function(t){e.on(t,function(t){console.log("Map",t.type),t.key&&console.log("New "+t.key,e.get(t.key))})}),"change change:center change:resolution change:rotation propertychange".split(" ").forEach(function(e){t.on(e,function(e){console.log("View",e.type),e.key&&console.log("New "+e.key,t.get(e.key))})}),t.on("change:resolution",function(){console.log("New zoom",t.getZoom())})},l=function(e){var r=e.getLayers();t.each(r,function(e,t){t.getVisible()?console.log("Selected layer",t.get("name")):console.log("Unselected layer",t.get("name")),t.on("change:visible",function(){this.getVisible()&&console.log("Selected layer",this.get("name"))})})},i=function(e,t,r){var o=e.getView();o.setCenter(ol.proj.transform([t,r],"EPSG:4326","EPSG:3857")),console.log("Map centered at longitude: "+t+" latitude: "+r)},s=function(e,t){t=parseInt(t),t&&e.getView().setZoom(t)},c=function(e,t){var r=e.getView();if(!t instanceof ol.extent)var t=r.getExtent();r.fit(t,e.getSize())},p=function(e){var t=e.getView(),r=ol.extent.createEmpty();e.getLayers().forEach(function(e){ol.extent.extend(r,e.getSource().getExtent())}),t.fit(r,e.getSize())},u=function(e,t){var r=t.getSource().getExtent();e.getView().fit(r,e.getSize())},m=function(e,r,o,n){var a=r.getSource(),l=a.getFeatureById(o),i=l.getGeometry(),s=e.getSize(),c=e.getView();c.fit(i,s,t.extend({padding:[0,0,0,0],constrainResolution:!1},n))},y=function(e){var r=t("#"+e.get("target"));r.toggleClass("map-horizontal",r.width()>r.height),r.toggleClass("map-vertical",r.width()<=r.height),r.toggleClass("map-narrow",r.width()<=n.narrowWidth),r.toggleClass("map-flat",r.height()<=n.flatHeight)},d=function(o,l){l=t.extend({},n,l),o.on("change:size",function(){});var i=t("#"+o.get("target"));if(i.bind("resize",function(){o.updateSize(),y(o)}),r.onresize=function(){o.updateSize(),y(o)},y(o),l.persistence)var s=e.initPersistence(o);else var s=!1;s||l.centerOnPosition&&(e.setCenterOnPosition(o),o.getView().setZoom(12)),l.debug&&a(o)};return t.extend(e,{initMap:d,fitLayerGeometry:m,fitLayers:p,fitVectorLayer:u,fitExtent:c,getSelectedBaseLayer:l,setCenter:i,settings:n,setZoom:s,updateSize:y})}(openlayersHelpers||{},window.jQuery,window,document),openlayersPredefinedControls=function(e,t,r,o){var n={};return n.attribution=function(){return new ol.control.Attribution({collapsible:!0})},n.sidebarToggler=function(){var e=o.createElement("button"),r=o.createElement("div");return r.className="ol-control ol-sidebar-toggler",r.appendChild(e),e.addEventListener("click",function(e){e.preventDefault();var r=o.querySelector(".map");r&&t(r).toggleClass("toggled").trigger("resize")},!1),new ol.control.Control({element:r,render:function(){}})},n.fullScreen=function(){return new ol.control.FullScreen({})},n.mousePosition=function(){return new ol.control.MousePosition({coordinateFormat:function(e){var t="<label>Longitude: </label><output>{x}°</output> <label>Latitude: </label><output>{y}°</output>";return ol.coordinate.format(e,t,4)},projection:"EPSG:4326",undefinedHTML:"<label>Longitude: </label><output></output> <label>Latitude: </label><output></output>"})},n.mousePositionBootstrap=function(){return new ol.control.MousePosition({coordinateFormat:function(e){var t='<form class="form-inline"><div class="form-group"><label class="control-label">Longitude</label><p class="form-control-static text-right">{x}°</p></div><div class="form-group"><label class="control-label">Latitude</label><p class="form-control-static text-right">{y}°</p></div></form>';return ol.coordinate.format(e,t,4)},projection:"EPSG:4326",undefinedHTML:'<form class="form-inline"><div class="form-group"><label class="control-label">Longitude</label><p class="form-control-static text-right">-</p></div><div class="form-group"><label class="control-label">Latitude</label><p class="form-control-static text-right">-</p></div></form>'})},n.mousePositionCustom=function(e){return new ol.control.MousePosition({coordinateFormat:function(e){var t="<strong>Longitude:</strong> {x}° <strong>Latitude:</strong> {y}°";return ol.coordinate.format(e,t,4)},projection:"EPSG:4326",className:"custom-mouse-position",target:o.getElementById(e||"mouse-position"),undefinedHTML:"<strong>Longitude:</strong> - <strong>Latitude:</strong> -"})},n.overviewMap=function(){return new ol.control.OverviewMap({collapseLabel:"«",label:"»",collapsed:!0})},n.rotate=function(){return new ol.control.Rotate({label:"⧫"})},n.rotateGlyphicon=function(){var e=o.createElement("span");return e.className="glyphicon glyphicon-arrow-up",new ol.control.Rotate({label:e})},n.scaleLine=function(){return new ol.control.ScaleLine({zIndex:2})},n.zoom=function(){return new ol.control.Zoom({})},n.zoomSlider=function(){return new ol.control.ZoomSlider({})},n.zoomToExtent=function(){return new ol.control.ZoomToExtent({label:"⊘",tipLabel:"Reset zoom"})},n.layerSwitcher=function(){return"undefined"!=typeof ol.control.LayerSwitcher?new ol.control.LayerSwitcher({}):!1},n}(openlayersHelpers||{},window.jQuery,window,document),openlayersPredefinedStyles=function(e,t,r,o){var n=(t.extend({},r.openlayersPredefinedStylesSettings),function(e,t){var r=0,o=e.get("name"),n=o.match(/([\-+]\d{2}):(\d{2})$/);if(n){var a=parseInt(n[1],10),l=parseInt(n[2],10);r=60*a+l}var i=new Date,s=new Date(i.getTime()+6e4*(i.getTimezoneOffset()+r)),c=Math.abs(12-s.getHours()+s.getMinutes()/60);c>12&&(c=24-c);var p=.75*(1-c/12);return[new ol.style.Style({fill:new ol.style.Fill({color:[85,85,85,p]}),stroke:new ol.style.Stroke({color:"#ffffff"})})]}),a=function(){var e=new ol.style.Fill({color:""}),t=new ol.style.Stroke({color:"",width:1}),r=new ol.style.Style({fill:e}),o=new ol.style.Style({stroke:t}),n=[];return function(a,l){var i=0,s=a.get("layer"),c=a.get("kind"),p=a.getGeometry().getType();return"water"===s&&"water-layer"===c||"water"===s&&"river"===c||"water"===s&&"stream"===c||"water"===s&&"canal"===c?(t.setColor("#9DD9D2"),t.setWidth(1.5),n[i++]=o):"water"===s&&"riverbank"===c?(e.setColor("#9DD9D2"),t.setWidth(1.5),n[i++]=r):"water"===s&&"water_boundary"===c||"water"===s&&"ocean_boundary"===c||"water"===s&&"riverbank_boundary"===c?(t.setColor("#93cbc4"),t.setWidth(.5),n[i++]=o):"water"===s||"ocean"===s||"lake"===s?(e.setColor("#9DD9D2"),n[i++]=r):"aeroway"===s&&"Polygon"===p?(e.setColor("#9DD9D2"),n[i++]=r):"aeroway"===s&&"LineString"===p&&76.43702828517625>=l?(t.setColor("#f0ede9"),t.setWidth(1),n[i++]=o):"landuse"===s&&"park"===c||"landuse"===s&&"national_park"===c||"landuse"===s&&"nature_reserve"===c||"landuse"===s&&"wood"===c||"landuse"===s&&"protected_land"===c?(e.setColor("#88D18A"),n[i++]=r):"landuse"===s&&"hospital"===c?(e.setColor("#fde"),n[i++]=r):"landuse"===s&&"school"===c?(e.setColor("#f0e8f8"),n[i++]=r):"boundaries"===s&&"country"===c?(t.setColor("#aaaaaa"),t.setWidth(1.5),n[i++]=o):"boundaries"!==s||"region"!==c&&"macroregion"!==c?l>3&&"road"===s&&"highway"===c?(t.setColor("#FA4A48"),t.setWidth(1.5),n[i++]=o):l>3&&"road"===s&&"major_road"===c?(t.setColor("#fb7b7a"),t.setWidth(1),n[i++]=o):l>3&&"road"===s&&"minor_road"===c?(t.setColor("#999"),t.setWidth(.5),n[i++]=o):"transit"===s&&"rail"===c?(t.setColor("#503D3F"),t.setWidth(.5),n[i++]=o):3>l&&"buildings"===s&&(t.setColor("#987284"),t.setWidth(.15),n[i++]=o):(t.setColor("#bbbbbb"),t.setWidth(.5),n[i++]=o),n.length=i,n}},l=new ol.style.Style({fill:new ol.style.Fill({color:"#666",opacity:.4}),stroke:new ol.style.Stroke({color:"#444",width:1})});return{timezonesStyle:n,mapzenVectorStyle:a,buildingStyle:l}}(openlayersHelpers||{},window.jQuery,window,document),openlayersPredefinedLayers=function(e,t,r,o){var n=t.extend({bingMapsKey:"",mapzenKey:"",thunderforestKey:"",mapquestKey:"",dataPath:"data/"},r.openlayersPredefinedLayersSettings),a="https:"===r.location.protocol?"https:":"http:",l={},i=function(){console.warm("ImageData function in development")},s=function(e,t){var r,o,n,a,l,s,c,p,u,m,y,d,f,g,h,w=e[0],b=w.width,S=w.height,v=w.data,T=new Uint8ClampedArray(v.length),L=2*t.resolution,z=b-1,M=S-1,x=[0,0,0,0],O=2*Math.PI,A=Math.PI/2,C=Math.PI*t.sunEl/180,H=Math.PI*t.sunAz/180,k=Math.cos(C),I=Math.sin(C);for(o=0;M>=o;++o)for(l=0===o?0:o-1,s=o===M?M:o+1,r=0;z>=r;++r)n=0===r?0:r-1,a=r===z?z:r+1,c=4*(o*b+n),x[0]=v[c],x[1]=v[c+1],x[2]=v[c+2],x[3]=v[c+3],p=t.vert*(x[0]+2*x[1]+3*x[2]),c=4*(o*b+a),x[0]=v[c],x[1]=v[c+1],x[2]=v[c+2],x[3]=v[c+3],u=t.vert*(x[0]+2*x[1]+3*x[2]),m=(u-p)/L,c=4*(l*b+r),x[0]=v[c],x[1]=v[c+1],x[2]=v[c+2],x[3]=v[c+3],p=t.vert*(x[0]+2*x[1]+3*x[2]),c=4*(s*b+r),x[0]=v[c],x[1]=v[c+1],x[2]=v[c+2],x[3]=v[c+3],u=t.vert*(x[0]+2*x[1]+3*x[2]),y=(u-p)/L,d=Math.atan(Math.sqrt(m*m+y*y)),f=Math.atan2(y,-m),f=0>f?A-f:f>A?O-f+A:A-f,g=I*Math.cos(d)+k*Math.sin(d)*Math.cos(H-f),c=4*(o*b+r),h=255*g,T[c]=h,T[c+1]=h,T[c+2]=h,T[c+3]=v[c+3];return new i(T,b,S)};return l.openStreetMap=function(){return new ol.layer.Tile({name:"openStreetMap",title:"Road Map (OpenStreetMap)",titleHtml:'Road Map<small> (by <a href="https://www.openstreetmap.org">OpenStreetMap</a>)</small>',visible:!0,type:"base",source:new ol.source.OSM({urls:[a+"//a.tile.openstreetmap.org/{z}/{x}/{y}.png"]})})},l.openSeaMap=function(){return new ol.layer.Tile({name:"openSeaMap",title:"Shipping lanes (OpenSeaMap)",titleHtml:'Shipping lanes<small> (by <a href="http://www.openseamap.org">OpenSeaMap</a>)</small>',type:"base",source:new ol.source.OSM({attributions:[new ol.Attribution({html:'All maps &copy; <a href="http://www.openseamap.org/">OpenSeaMap</a>'}),ol.source.OSM.ATTRIBUTION],crossOrigin:null,urls:["http://tiles.openseamap.org/seamark/{z}/{x}/{y}.png","http://t1.openseamap.org/seamark/{z}/{x}/{y}.png"]})})},l.openStreetMapHumanitarian=function(){return new ol.layer.Tile({name:"openStreetMapHumanitarian",title:"Humanitarian  (OpenStreetMap)",titleHtml:'Humanitarian <small>(by <a href="https://www.openstreetmap.org">OpenStreetMap</a>)</small>',type:"base",source:new ol.source.OSM({attributions:[new ol.Attribution({html:'All maps &copy; <a href="http://www.openstreetmap.fr/">OpenStreetMap</a>'}),ol.source.OSM.ATTRIBUTION],url:a+"//tile-{a-c}.openstreetmap.fr/hot/{z}/{x}/{y}.png"})})},l.openCycleMap=function(){return new ol.layer.Tile({name:"openCycleMap",title:"Cycling roads (OpenCycleMap)",titleHtml:'Cycling roads<small> (by <a href="http://www.opencyclemap.org">OpenCycleMap</a>)</small>',type:"base",source:new ol.source.OSM({attributions:[new ol.Attribution({html:'All maps &copy; <a href="http://www.opencyclemap.org/">OpenCycleMap</a>'}),ol.source.OSM.ATTRIBUTION],url:"http://{a-c}.tile.opencyclemap.org/cycle/{z}/{x}/{y}.png?apikey="+n.thunderforestKey})})},l.thunderforestTransport=function(){return new ol.layer.Tile({name:"thunderforestTransport",title:"Transports (ThunderForest)",titleHtml:'Transports<small> (by <a href="http://www.thunderforest.com">ThunderForest</a>)</small>',type:"base",source:new ol.source.OSM({attributions:[new ol.Attribution({html:'All maps &copy; <a href="http://www.thunderforest.com/">ThunderForest</a>'}),ol.source.OSM.ATTRIBUTION],url:"http://{a-c}.tile.thunderforest.com/transport/{z}/{x}/{y}.png?apikey="+n.thunderforestKey})})},l.thunderforestTransportDark=function(){return new ol.layer.Tile({name:"thunderforestTransportDark",title:"Transport dark (ThunderForest)",titleHtml:'Transport dark<small> (by <a href="http://www.thunderforest.com">ThunderForest</a>)</small>',type:"base",source:new ol.source.OSM({attributions:[new ol.Attribution({html:'All maps &copy; <a href="http://www.thunderforest.com/">ThunderForest</a>'}),ol.source.OSM.ATTRIBUTION],url:"https://{a-c}.tile.thunderforest.com/transport-dark/{z}/{x}/{y}.png?apikey="+n.thunderforestKey})})},l.thunderforestLandscape=function(){return new ol.layer.Tile({name:"thunderforestLandscape",title:"Landscape (ThunderForest)",titleHtml:'Landscape<small> (by <a href="http://www.thunderforest.com">ThunderForest</a>)</small>',type:"base",source:new ol.source.OSM({attributions:[new ol.Attribution({html:'All maps &copy; <a href="http://www.thunderforest.com/">ThunderForest</a>'}),ol.source.OSM.ATTRIBUTION],url:"https://{a-c}.tile.thunderforest.com/landscape/{z}/{x}/{y}.png?apikey="+n.thunderforestKey})})},l.thunderforestOutdoor=function(){return new ol.layer.Tile({name:"thunderforestOutdoor",title:"Outdoor activities (ThunderForest)",titleHtml:'Outdoor activities<small> (by <a href="http://www.thunderforest.com">ThunderForest</a>)</small>',type:"base",source:new ol.source.OSM({attributions:[new ol.Attribution({html:'All maps &copy; <a href="http://www.thunderforest.com/">ThunderForest</a>'}),ol.source.OSM.ATTRIBUTION],url:"https://{a-c}.tile.thunderforest.com/outdoors/{z}/{x}/{y}.png?apikey="+n.thunderforestKey})})},l.arcgis=function(){return new ol.layer.Tile({name:"arcgis",title:"Terrain (ArcGIS)",titleHtml:'Terrain<small> (by <a href="https://services.arcgisonline.com">ArcGIS</a>)</small>',type:"base",source:new ol.source.XYZ({crossOrigin:"anonymous",attributions:[new ol.Attribution({html:'Tiles &copy; <a href="https://services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer">ArcGIS</a>'})],url:a+"//server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}"})})},l.arcgisRestHighwayUSA=function(){return new ol.layer.Tile({name:"arcgisRestHighwayUSA",title:"Highway USA (ArcGIS)",titleHtml:'Highway USA<small> (by <a href="https://services.arcgisonline.com">ArcGIS</a>)</small>',type:"base",extent:[-13884991,2870341,-7455066,6338219],source:new ol.source.TileArcGISRest({url:a+"//sampleserver1.arcgisonline.com/ArcGIS/rest/services/Specialty/ESRI_StateCityHighway_USA/MapServer"})})},l.googleMap=function(){return new ol.layer.Tile({name:"googleMap",title:"Road map (Google)",titleHtml:'Road map<small> (by <a href="https://www.google.com/maps/">Google</a>)</small>',type:"base",source:new ol.source.XYZ({crossOrigin:"anonymous",url:a+"//mt1.google.com/vt/lyrs=m@285235804&hl=en&x={x}&y={y}&z={z}&s=1"})})},l.googleTerrain=function(){return new ol.layer.Tile({name:"googleTerrain",title:"Terrain + labels (Google)",titleHtml:'Terrain + labels<small> (by <a href="https://www.google.com/maps/">Google</a>)</small>',type:"base",source:new ol.source.XYZ({crossOrigin:"anonymous",url:a+"//mts1.google.com/vt/lyrs=t@132,r@285000000&hl=en&src=app&x={x}&y={y}&z={z}&s=1"})})},l.googleSatellite=function(){return new ol.layer.Tile({name:"googleSatellite",title:"Aerial view (Google)",titleHtml:'Aerial view<small> (by <a href="https://www.google.com/maps/">Google</a>)</small>',type:"base",source:new ol.source.XYZ({crossOrigin:"anonymous",url:a+"//www.google.se/maps/vt/pb=!1m5!1m4!1i{z}!2i{x}!3i{y}!4i256!2m2!1e1!3i198!4e0"})})},l.bingRoad=function(){return new ol.layer.Tile({name:"bingRoad",title:"Road map (Bing)",titleHtml:'Road map<small> (by <a href="https://www.bing.com/maps/">Bing</a>)</small>',type:"base",maxZoom:19,source:new ol.source.BingMaps({key:n.bingMapsKey,imagerySet:"Road"})})},l.bingAerial=function(){return new ol.layer.Tile({name:"bingAerial",title:"Aerial view (Bing)",titleHtml:'Aerial view<small> (by <a href="https://www.bing.com/maps/">Bing</a>)</small>',type:"base",maxZoom:19,source:new ol.source.BingMaps({key:n.bingMapsKey,imagerySet:"Aerial"})})},l.bingAerialWithLabels=function(){return new ol.layer.Tile({name:"bingAerialWithLabels",title:"Aerial view with labels (Bing)",titleHtml:'Aerial view with labels<small> (by <a href="https://www.bing.com/maps/">Bing</a>)</small>',type:"base",maxZoom:19,source:new ol.source.BingMaps({key:n.bingMapsKey,imagerySet:"AerialWithLabels"})})},l.bingCollinsBart=function(){return new ol.layer.Tile({name:"bingCollinsBart",title:"CollinsBart (Bing)",titleHtml:'CollinsBart<small> (by <a href="https://www.bing.com/maps/">Bing</a>)</small>',type:"base",maxZoom:19,source:new ol.source.BingMaps({key:n.bingMapsKey,imagerySet:"collinsBart"})})},l.bingOrdnanceSurvey=function(){return new ol.layer.Tile({name:"bingOrdnanceSurvey",title:"OrdnanceSurvey (Bing)",titleHtml:'OrdnanceSurvey<small> (by <a href="https://www.bing.com/maps/">Bing</a>)</small>',type:"base",maxZoom:19,source:new ol.source.BingMaps({key:n.bingMapsKey,imagerySet:"ordnanceSurvey"})})},l.stamenToner=function(){return new ol.layer.Tile({name:"stamenToner",title:"B&W map (Stamen)",titleHtml:'B&W map<small> (by <a href="http://maps.stamen.com">Stamen</a>)</small>',type:"base",source:new ol.source.Stamen({attributions:[new ol.Attribution({html:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. Data by <a href="http://openstreetmap.org">OpenStreetMap</a>, under <a href="http://www.openstreetmap.org/copyright">ODbL</a>.'})],layer:"toner"})})},l.stamenTonerLite=function(){return new ol.layer.Tile({name:"stamenTonerLite",title:"Gray scale map (Stamen)",titleHtml:'Gray scale map<small> (by <a href="http://maps.stamen.com">Stamen</a>)</small>',type:"base",source:new ol.source.Stamen({attributions:[new ol.Attribution({html:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. Data by <a href="http://openstreetmap.org">OpenStreetMap</a>, under <a href="http://www.openstreetmap.org/copyright">ODbL</a>.'})],layer:"toner-lite"})})},l.stamenTonerBackground=function(){return new ol.layer.Tile({name:"stamenTonerBackground",title:"B&W background (Stamen)",titleHtml:'B&W background<small> (by <a href="http://maps.stamen.com">Stamen</a>)</small>',type:"base",source:new ol.source.Stamen({attributions:[new ol.Attribution({html:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. Data by <a href="http://openstreetmap.org">OpenStreetMap</a>, under <a href="http://www.openstreetmap.org/copyright">ODbL</a>.'})],layer:"toner-background"})})},l.stamenWatercolor=function(){return new ol.layer.Tile({name:"stamenWatercolor",title:"Watercolor map (Stamen)",titleHtml:'Watercolor map<small> (by <a href="http://maps.stamen.com">Stamen</a>)</small>',type:"base",source:new ol.source.Stamen({attributions:[new ol.Attribution({html:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. Data by <a href="http://openstreetmap.org">OpenStreetMap</a>, under <a href="http://creativecommons.org/licenses/by-sa/3.0">CC BY SA</a>.'})],layer:"watercolor"})})},l.stamenTerrain=function(){return new ol.layer.Tile({name:"stamenTerrain",title:"Terrain + labels (Stamen)",titleHtml:'Terrain + labels <small> (by <a href="http://maps.stamen.com">Stamen</a>)</small>',type:"base",source:new ol.source.Stamen({attributions:[new ol.Attribution({html:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. Data by <a href="http://openstreetmap.org">OpenStreetMap</a>, under <a href="http://www.openstreetmap.org/copyright">ODbL</a>.'})],layer:"terrain"})})},l.stamenTerrainBackground=function(){return new ol.layer.Tile({name:"stamenTerrainBackground",title:"Terrain (Stamen)",titleHtml:'Terrain <small> (by <a href="http://maps.stamen.com">Stamen</a>)</small>',type:"base",source:new ol.source.Stamen({attributions:[new ol.Attribution({html:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. Data by <a href="http://openstreetmap.org">OpenStreetMap</a>, under <a href="http://www.openstreetmap.org/copyright">ODbL</a>.'})],layer:"terrain-background"})})},l.customBaseLayer=function(){return new ol.layer.Tile({name:"customBaseLayer",title:"Custom",type:"base",source:new ol.source.XYZ({urls:[]})})},l.mapsForFreeRelief=function(){return new ol.layer.Tile({name:"mapsForFreeRelief",title:"Relief (maps-for-free.com)",titleHtml:"Custom",type:"base",source:new ol.source.XYZ({urls:[]})})},l.mapsForFreeRelief=function(){return new ol.layer.Tile({name:"mapsForFreeRelief",title:'Relief<small> (by <a href="http://www.maps-for-free.com">maps-for-free.com</a>)</small>',type:"base",source:new ol.source.XYZ({maxZoom:12,urls:["http://www.maps-for-free.com/layer/relief/z{z}/row{y}/{z}_{x}-{y}.jpg"]})})},l.mapzenVector=function(){return new ol.layer.VectorTile({name:"mapzenVector",title:"Vector map  (mapzen.com)",titleHtml:'Vector map <small> (by <a href="http://www.mapzen.com">mapzen.com</a>)</small>',type:"base",source:new ol.source.VectorTile({attributions:[new ol.Attribution({html:"&copy; OpenStreetMap contributors, Who’s On First, Natural Earth, and openstreetmapdata.com"})],format:new ol.format.TopoJSON,tileGrid:ol.tilegrid.createXYZ({maxZoom:19}),url:"https://tile.mapzen.com/mapzen/vector/v1/all/{z}/{x}/{y}.topojson?api_key="+n.mapzenKey}),style:openlayersPredefinedStyles.mapzenVectorStyle()})},l.mapzenVectorBuildings=function(){return new ol.layer.VectorTile({name:"mapzenVectorBuildings",title:"Vector bildings (mapzen.com)",titleHtml:'Vector bildings<small> (by <a href="http://www.mapzen.com">mapzen.com</a>)</small>',type:"base",source:new ol.source.VectorTile({attributions:[new ol.Attribution({html:"&copy; OpenStreetMap contributors, Who’s On First, Natural Earth, and openstreetmapdata.com"})],format:new ol.format.TopoJSON,url:"https://tile.mapzen.com/mapzen/vector/v1/buildings/{z}/{x}/{y}.topojson?api_key="+n.mapzenKey}),style:openlayersPredefinedStyles.mapzenVectorStyle()})},l.mapzenVectorWater=function(){return new ol.layer.VectorTile({name:"mapzenVectorWater",title:"Vector water (mapzen.com)",titleHtml:'Vector water<small> (by <a href="http://www.mapzen.com">mapzen.com</a>)</small>',type:"base",source:new ol.source.VectorTile({attributions:[new ol.Attribution({html:"&copy; OpenStreetMap contributors, Who’s On First, Natural Earth, and openstreetmapdata.com"})],format:new ol.format.TopoJSON,tileGrid:ol.tilegrid.createXYZ({maxZoom:19}),url:"https://tile.mapzen.com/mapzen/vector/v1/water/{z}/{x}/{y}.topojson?api_key="+n.mapzenKey}),style:openlayersPredefinedStyles.mapzenVectorStyle()})},l.mapzenVectorPois=function(){return new ol.layer.VectorTile({name:"mapzenVectorPois",title:"Vector POIs (mapzen.com)",titleHtml:'Vector POIs<small> (by <a href="http://www.mapzen.com">mapzen.com</a>)</small>',type:"base",source:new ol.source.VectorTile({attributions:[new ol.Attribution({html:"&copy; OpenStreetMap contributors, Who’s On First, Natural Earth, and openstreetmapdata.com"})],format:new ol.format.TopoJSON,tileGrid:ol.tilegrid.createXYZ({maxZoom:19}),url:"https://tile.mapzen.com/mapzen/vector/v1/pois/{z}/{x}/{y}.topojson?api_key="+n.mapzenKey}),style:openlayersPredefinedStyles.mapzenVectorStyle()})},l.mapzenTerrain=function(e){return new ol.layer.VectorTile({name:"mapzenTerrain",title:"Terrain  (mapzen.com)",titleHtml:'Terrain <small> (by <a href="http://www.mapzen.com">mapzen.com</a>)</small>',type:"base",source:new ol.source.XYZ({attributions:[new ol.Attribution({html:"&copy; OpenStreetMap contributors, Who’s On First, Natural Earth, and openstreetmapdata.com"})],url:"https://tile.mapzen.com/mapzen/terrain/v1/normal/{z}/{x}/{y}.png?api_key="+n.mapzenKey})})},l.mapzenTerrainTerrarium=function(e){return new ol.layer.VectorTile({name:"mapzenTerrainTerrarium",title:"Terrarium  (mapzen.com)",titleHtml:'Terrarium <small> (by <a href="http://www.mapzen.com">mapzen.com</a>)</small>',type:"base",source:new ol.source.XYZ({attributions:[new ol.Attribution({html:"&copy; OpenStreetMap contributors, Who’s On First, Natural Earth, and openstreetmapdata.com"})],url:"https://tile.mapzen.com/mapzen/terrain/v1/terrarium/{z}/{x}/{y}.png?api_key="+n.mapzenKey})})},l.googleBike=function(){return new ol.layer.Tile({name:"googleBike",title:"Cycling roads (Google)",titleHtml:'Cycling roads<small> (by <a href="https://www.google.com/maps/">Google</a>)</small>',visible:!0,source:new ol.source.XYZ({crossOrigin:"anonymous",url:a+"//mts0.google.com/vt/lyrs=h@239000000,bike&hl=en&src=app&x={x}&y={y}&z={z}&s=1"})})},l.googleHybrid=function(){return new ol.layer.Tile({name:"googleHybrid",title:"Roads + labels (Google)",titleHtml:'Roads + labels<small> (by <a href="https://www.google.com/maps/">Google</a>)</small>',zIndex:99,visible:!0,source:new ol.source.XYZ({crossOrigin:"anonymous",url:a+"//mt1.google.com/vt/lyrs=h@239000000&hl=en&x={x}&y={y}&z={z}&s=1"})})},l.lonviaCycling=function(){return new ol.layer.Tile({name:"lonviaCycling",title:"Cycling roads (Lonvia)",titleHtml:'Cycling roads<small> (by <a href="http://www.waymarkedtrails.org">Lonvia</a>)</small>',opacity:.6,source:new ol.source.OSM({attributions:[new ol.Attribution({html:'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> and contributors <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>'}),ol.source.OSM.ATTRIBUTION],crossOrigin:null,url:"http://tile.lonvia.de/cycling/{z}/{x}/{y}.png"})})},l.lonviaHiking=function(){return new ol.layer.Tile({name:"lonviaHiking",title:"Hiking paths (Lonvia)",titleHtml:'Hiking paths<small> (by <a href="http://www.waymarkedtrails.org">Lonvia</a>)</small>',opacity:.6,source:new ol.source.OSM({attributions:[new ol.Attribution({html:'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> and contributors <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>'}),ol.source.OSM.ATTRIBUTION],crossOrigin:null,url:"http://tile.lonvia.de/hiking/{z}/{x}/{y}.png"})})},l.stamenTerrainLabels=function(){return new ol.layer.Tile({name:"stamenTerrainLabels",title:"Labels (Stamen)",titleHtml:'Labels <small> (by <a href="http://maps.stamen.com">Stamen</a>)</small>',zIndex:99,source:new ol.source.Stamen({attributions:[new ol.Attribution({html:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. Data by <a href="http://openstreetmap.org">OpenStreetMap</a>, under <a href="http://www.openstreetmap.org/copyright">ODbL</a>.'
})],layer:"terrain-labels"})})},l.stamenTerrainLines=function(){return new ol.layer.Tile({name:"stamenTerrainLines",title:"Roads (Stamen)",titleHtml:'Roads <small> (by <a href="http://maps.stamen.com">Stamen</a>)</small>',source:new ol.source.Stamen({attributions:[new ol.Attribution({html:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. Data by <a href="http://openstreetmap.org">OpenStreetMap</a>, under <a href="http://www.openstreetmap.org/copyright">ODbL</a>.'})],layer:"terrain-lines"})})},l.stamenTonerHybrid=function(){return new ol.layer.Tile({name:"stamenTonerHybrid",title:"B&W roads + labels (Stamen)",titleHtml:'B&W roads + labels<small> (by <a href="http://maps.stamen.com">Stamen</a>)</small>',zIndex:99,source:new ol.source.Stamen({attributions:[new ol.Attribution({html:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. Data by <a href="http://openstreetmap.org">OpenStreetMap</a>, under <a href="http://www.openstreetmap.org/copyright">ODbL</a>.'})],layer:"toner-hybrid"})})},l.stamenTonerLabels=function(){return new ol.layer.Tile({name:"stamenTonerLabels",title:"B&W labels (Stamen)",titleHtml:'B&W labels<small> (by <a href="http://maps.stamen.com">Stamen</a>)</small>',zIndex:99,source:new ol.source.Stamen({attributions:[new ol.Attribution({html:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. Data by <a href="http://openstreetmap.org">OpenStreetMap</a>, under <a href="http://www.openstreetmap.org/copyright">ODbL</a>.'})],layer:"toner-labels"})})},l.stamenTonerLines=function(){return new ol.layer.Tile({name:"stamenTonerLines",title:"B&W roads (Stamen)",titleHtml:'B&W roads<small> (by <a href="http://maps.stamen.com">Stamen</a>)</small>',source:new ol.source.Stamen({attributions:[new ol.Attribution({html:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. Data by <a href="http://openstreetmap.org">OpenStreetMap</a>, under <a href="http://www.openstreetmap.org/copyright">ODbL</a>.'})],layer:"toner-lines"})})},l.mapsForFreeWater=function(){return new ol.layer.Tile({name:"mapsForFreeWater",title:"Water (maps-for-free.com)",titleHtml:'Water<small> (by <a href="http://www.maps-for-free.com">maps-for-free.com</a>)</small>',opacity:.7,source:new ol.source.XYZ({url:"http://www.maps-for-free.com/layer/water/z{z}/row{y}/{z}_{x}-{y}.gif"})})},l.mapsForFreeAdmin=function(){return new ol.layer.Tile({name:"mapsForFreeAdmin",title:"Admin (maps-for-free.com)",titleHtml:'Admin<small> (by <a href="http://www.maps-for-free.com">maps-for-free.com</a>)</small>',opacity:.3,source:new ol.source.XYZ({url:"http://www.maps-for-free.com/layer/admin/z{z}/row{y}/{z}_{x}-{y}.gif"})})},l.uniHeidelbergAsterh=function(){return new ol.layer.Tile({name:"uniHeidelbergAsterh",title:"Hillshade (uni-heidelberg.de)",titleHtml:'Hillshade<small> (by <a href="http://korona.geog.uni-heidelberg.de">uni-heidelberg.de</a>)</small>',source:new ol.source.XYZ({maxZoom:18,url:"http://korona.geog.uni-heidelberg.de/tiles/asterh/x={x}&y={y}&z={z}"})})},l.uniHeidelbergAdminb=function(){return new ol.layer.Tile({name:"uniHeidelbergAdminb",title:"Admin boundaries (uni-heidelberg.de)",titleHtml:'Admin boundaries<small> (by <a href="http://korona.geog.uni-heidelberg.de">uni-heidelberg.de</a>)</small>',opacity:.8,source:new ol.source.XYZ({url:"http://korona.geog.uni-heidelberg.de/tiles/adminb/x={x}&y={y}&z={z}"})})},l.uniHeidelbergHybrid=function(){return new ol.layer.Tile({name:"uniHeidelbergHybrid",title:"Hibrid (uni-heidelberg.de)",titleHtml:'Hibrid<small> (by <a href="http://korona.geog.uni-heidelberg.de">uni-heidelberg.de</a>)</small>',opacity:.8,source:new ol.source.XYZ({url:"http://korona.geog.uni-heidelberg.de/tiles/hybrid/x={x}&y={y}&z={z}"})})},l.mapboxShadedRelief=function(){return new ol.layer.Image({name:"mapboxShadedRelief",title:"Shaded relief (Mapbox)",titleHtml:'Shaded relief<small> (by <a href="http://www.mapbox.com">Mapbox</a>)</small>',source:new ol.source.Raster({sources:[new ol.source.XYZ({url:"https://{a-d}.tiles.mapbox.com/v3/aj.sf-dem/{z}/{x}/{y}.png",crossOrigin:"anonymous"})],operationType:"image",operation:s}),opacity:.3})},l.timeZones=function(){return new ol.layer.Vector({name:"timeZones",title:"Time zones",style:openlayersPredefinedStyles.timezonesStyle,minResolution:4891,source:new ol.source.Vector({extractStyles:!1,projection:"EPSG:3857",url:dataPath+"timezones.kml",format:new ol.format.KML})})},l.gpxFile=function(){return new ol.layer.Vector({name:"gpxFile",title:"GPS tracks",visible:!1,source:new ol.source.Vector({url:"",format:new ol.format.GPX}),style:new ol.style.Style({stroke:new ol.style.Stroke({color:"#33ff00",width:5})})})},l.drawingVector=function(){return new ol.layer.Tile({name:"drawing",title:"My drawings"})},l.customOverlay=function(){return new ol.layer.Tile({name:"customOverlay",title:"Custom",source:new ol.source.XYZ({urls:[]})})},l}(openlayersHelpers||{},window.jQuery,window,document),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};ol.control.LayerSwitcher.prototype.renderLayer_=function(e,t){var r=this,o=document.createElement("li"),n=e.get("title"),a=e.get("title").replace(/\s+/g,"-")+"_"+t,l=document.createElement("label");if(e.getLayers){o.className="group",l.innerHTML=n,o.appendChild(l);var i=document.createElement("ul");o.appendChild(i),this.renderLayers_(e,i)}else{o.className="layer";var s=document.createElement("input");"base"===e.get("type")?(s.type="radio",s.name="base"):s.type="checkbox",s.id=a,s.checked=e.get("visible"),s.onchange=function(t){r.setVisible_(e,t.target.checked)},o.appendChild(s);var c=document.createElement("a");c.href="#layer-settings-modal",c.setAttribute("data-toggle","modal"),c.setAttribute("data-layer-name",e.get("name")),c.className="layer-settings-toggler",o.appendChild(c),l.htmlFor=a,l.innerHTML=n,o.appendChild(l)}return o};var openlayersLayerSettings=function(mod,$,window,document){var settings={mapSelector:".map",formSelector:"#layer-settings-form",formGroupSelector:".form-group",modalSelector:"#layer-settings-modal"},selectedLayer,olStyleTypeGetters={Fill:"getFill",Image:"getImage",Stroke:"getStroke",Text:"getText"},olStylePropertyGetters={color:"getColor",lineCap:"getLineCap",geometry:"getGeometry",geometryFunction:"getGeometryFunction",lineDash:"getLineDash",lineJoin:"getLineJoin",miterLimit:"getMiterLimit",width:"getWidth",zIndex:"getZIndex"},olStylePropertySetters={color:"setColor",lineCap:"setLineCap",geometry:"setGeometry",geometryFunction:"setGeometryFunction",lineDash:"setLineDash",lineJoin:"setLineJoin",miterLimit:"setMiterLimit",width:"setWidth",zIndex:"getZIndex"},validateLayerInputs=function(){var e,t,r,o,n;if(!$().parsley)return console.warn("Parsley is not defined"),!1;var a=$(settings.formSelector);a.parsley({excluded:"input[type=button], input[type=submit], input[type=reset], input[type=hidden], [disabled], :hidden"}).on("field:success",function(){e=this.$element,e.is("[data-ol-layer][data-ol-property]")&&(t=e.data("ol-property"),r=mod.getInputValue(e),t&&null!==r&&selectedLayer.set(t,r)),e.is('[data-ol-source][data-ol-property="urls"]')&&(r=mod.getInputValue(e),r=r.split("\n"),mod.updateSourceUrl(selectedLayer,r)),e.is('[data-ol-source="Vector"][data-ol-format="GPX"]')&&(r=mod.getInputValue(e),mod.loadFileFeatures(selectedLayer,r,{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"})),e.is("[data-ol-style][data-ol-property]")&&(t=e.data("ol-property"),r=mod.getInputValue(e),n=e.data("ol-style"),o=selectedLayer.getStyle(),olStyleTypeGetters[n]&&_typeof(o[olStyleTypeGetters[n]])&&source.getKeys().forEach(function(e){o=o[olStyleTypeGetters[n]](),olStylePropertySetters[t]&&_typeof(o[olStylePropertySetters[t]])&&o[olStylePropertySetters[t]](r)}))}).on("form:submit",function(){return!1})},initLayerInputs=function(e){var t,r,o,n,a,l=$(settings.formSelector),i=l.find(settings.formGroupSelector);selectedLayer=e,i.hide();var s=mod.getInstanceTypes(e,ol.layer),c=e.getKeys(),p=e.getProperties(e);if("function"==typeof e.getSource)var u=e.getSource();if("function"==typeof e.getStyle)var m=e.getStyle();var y=s;if(y.push("*"),y.forEach(function(e){r=i.has('[data-ol-layer="'+e+'"]'),c.forEach(function(t){r.has('[data-ol-property="'+t+'"]').show().find("label small").html("("+e+")")})}),u){var d=mod.getInstanceTypes(u,ol.source),f=u.getKeys(),g=u.getProperties(e);if("function"==typeof u.getFormat)var h=u.getFormat();var w={};if(u.getKeys().forEach(function(e){n=u.get(e),n&&!g[e]&&(w[e]=n)}),console.log("Source extra properties",w),y=d,y.push("*"),y.forEach(function(e){r=i.has('[data-ol-source="'+e+'"]'),f.forEach(function(t){r.has('[data-ol-property="'+t+'"]').show().find("label small").html("("+e+")")}),$.each(w,function(t){r.has('[data-ol-property="'+t+'"]').show().find("label small").html("("+e+")")})}),h){var b=mod.getInstanceTypes(h,ol.format);console.log("Layer format types",b),y=b,y.push("*"),y.forEach(function(e){r=i.has('[data-ol-format="'+e+'"]'),r.show().find("label small").html("("+e+")")}),r.has('[data-ol-format=""]').show()}}if(m){var S=mod.getInstanceTypes(m,ol.style);console.log("Layer style types",S);var v={};$.each(olStyleTypeGetters,function(e,t){v[e]={},n=m[t](),n&&(S=mod.getInstanceTypes(n,ol.style),S?(console.log("Child style "+e+" found",S),y=S,y.push("*"),y.forEach(function(t){r=i.has('[data-ol-style="'+t+'"]'),$.each(olStylePropertyGetters,function(o,a){"function"==typeof n[a]&&(n=n[a](),v[e][o]=n,r.has('[data-ol-property="'+o+'"]').show().find("label small").html("("+t+")"))})})):v[e]=n)}),console.log("Layer style properties",v)}if(p&&i.find(":input").filter("[data-ol-layer][data-ol-property]").each(function(){t=$(this),o=t.data("ol-property"),null!==p[o]&&(n=p[o],a=-1!==["visible","opacity"].indexOf(o)&&"base"===p.type?{disabled:"disabled"}:{},mod.setInputValue(t,n,a),console.log("Layer property "+o+" populated",n))}),g&&i.find(":input").filter("[data-ol-source][data-ol-property]").each(function(){t=$(this),o=t.data("ol-property"),null!==g[o]&&(n=g[o],a=-1!==["url","urls"].indexOf(o)?{}:{},mod.setInputValue(t,n,a),console.log("Source property "+o+" populated",n))}),w&&i.find(":input").filter("[data-ol-source][data-ol-property]").each(function(){t=$(this),o=t.data("ol-property"),null!==w[o]&&(n=w[o],mod.setInputValue(t,n),console.log("Source property "+o+" populated",n))}),b&&i.find(":input").filter('[data-ol-source="Vector"][data-ol-format="GPX"]').each(function(){console.log('Layer input "file" ready',n)}),v){var T;i.find(":input").filter("[data-ol-style][data-ol-property]").each(function(){t=$(this),T=t.data("ol-style"),o=t.data("ol-property"),T&&o&&v[T]&&null!==v[T][o]&&(n=v[T][o],console.log(T+" "+o+" ("+("undefined"==typeof n?"undefined":_typeof(n))+")",n),mod.setInputValue(t,n))})}validateLayerInputs()},initLayerInputsBootstrapModal=function initLayerInputsBootstrapModal(modalSelector){$(modalSelector).on("show.bs.modal",function(e){var $modal=$(this),layerName=$(e.relatedTarget).data("layer-name");if("undefined"!=typeof layerVarName&&(selectedLayer=eval(layerName+"Layer")),selectedLayer){initLayerInputs(settings.selectedLayer);var title=selectedLayer.get("title");$modal.find(".modal-title").html(title)}})},init=function(e,t){$.extend(settings,t);var r=$(settings.mapSelector),o=$(settings.formSelector),n=$(settings.modalSelector);mod.getControlInstanceOf(e,"LayerSwitcher");r.find(".layer-switcher").on("click",'a[data-toggle="modal"]',function(e){e.preventDefault(),$(this).trigger("click.bs.modal.data-api")}),n.on("show.bs.modal",function(t){var r=$(this),o=$(t.relatedTarget),n=o.siblings("input").first().attr("id"),a=o.data("layerName");console.log("Selected layer ID",n),ol.control.LayerSwitcher.forEachRecursive(e,function(e,t,o){var l=e.get("title");if(l)var i=l.replace(/\s+/g,"-")+"_"+t;var s=e.get("name");console.log("Layer ID",i),(s&&a&&s===a||i&&n&&i===n)&&(r.find(".modal-title").html(l),initLayerInputs(e))})}),o.on("submit",function(e){e.preventDefault(),n.modal("hide")})};return $(function(){}),{init:init}}(openlayersHelpers||{},window.jQuery,window,document),openlayersPersistence=function(e,t,r,o){var n={},a=function(t,r,o){"string"!=typeof r&&(r=e.stringify(r)),"undefined"!=typeof Storage&&localStorage.setItem([o,t].join("_"),r)},l=function(t,r){var o;return"undefined"!=typeof Storage&&(o=localStorage.getItem([r,t].join("_"))),null!==o&&(o=e.parse(o)),o},i=function(e){var t=e.getView();t.on("propertychange",function(){var r=t.getProperties(),o=e.get("target");a("view_properties",r,o)})},s=function(e){var t=!1,r=e.get("target"),o=l("view_properties",r);if(void 0!==o){var n=e.getView();n.setProperties(o),t=!0}return t},c=function(t){e.forEachLayerRecursive(t,function(e,r,o){e.on("propertychange",function(){var e=this.getProperties();delete e.source;var o=this.get("title"),n="layer_properties_"+o.replace(/[\s]+/g,"_")+"_"+r,l=t.get("target");a(n,e,l)})})},p=function(t){var r=!1;return e.forEachLayerRecursive(t,function(e,o,n){var a=e.get("title"),i="layer_properties_"+a.replace(/[\s]+/g,"_")+"_"+o,s=t.get("target"),c=l(i,s);void 0!==c&&(e.setProperties(c),r=!0)}),r},u=function(e,r){n=t.extend(n,r);var o=!1;return o=s(e),p(e),i(e),c(e),console.log("Map persistence",o),o};return t.extend(e,{initPersistence:u})}(openlayersHelpers||{},window.jQuery,window,document),openlayersGeolocation=function(e,t,r,o){var n=function(e){var t=e.getView(),r=new ol.Geolocation({projection:t.getProjection(),tracking:!0});r.once("change:position",function(){t.setCenter(r.getPosition())})};return t.extend(e,{setCenterOnPosition:n})}(openlayersHelpers||{},window.jQuery,window,document);